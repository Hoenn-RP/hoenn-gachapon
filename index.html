<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/pokeapi-js-wrapper/dist/index.js"></script>
    <link rel="stylesheet" href="https://hoenn-rp.github.io/hoenn-gachapon/styles/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins&family=Loto&family=Montserrat&family=Quattrocento+Sans&family=Roboto&display=swap" rel="stylesheet">
    <link href="https://file.myfontastic.com/MoFUsEGeKpGshm3e6HMZEG/icons.css" rel="stylesheet">
    <title>Hoenn Gachapon</title>
</head>
<body>

    <h1>Hoenn Gachapon</h1>

    <div class="buttonselection">
      <button onclick="generateTemplate('normal')"><i class="icon-normal"></i></button>
    <button onclick="generateTemplate('fire')"><i class="icon-fire"></i></button>
    <button onclick="generateTemplate('water')"><i class="icon-water"></i></button>
    <button onclick="generateTemplate('electric')"><i class="icon-electric"></i></button>
    <button onclick="generateTemplate('grass')"><i class="icon-grasstype"></i></button>
    <button onclick="generateTemplate('ice')"><i class="icon-ice"></i></button>
    <button onclick="generateTemplate('fighting')"><i class="icon-fighting"></i></button>
    <button onclick="generateTemplate('poison')"><i class="icon-poison"></i></button>
    <button onclick="generateTemplate('ground')"><i class="icon-ground"></i></button>
    <button onclick="generateTemplate('flying')"><i class="icon-flying"></i></button>
    <button onclick="generateTemplate('psychic')"><i class="icon-psychic"></i></button>
    <button onclick="generateTemplate('bug')"><i class="icon-bug"></i></button>
    <button onclick="generateTemplate('rock')"><i class="icon-rock"></i></button>
    <button onclick="generateTemplate('ghost')"><i class="icon-ghost"></i></button>
    <button onclick="generateTemplate('dark')"><i class="icon-dark"></i></button>
    <button onclick="generateTemplate('steel')"><i class="icon-steel"></i></button>
    <button onclick="generateTemplate('dragon')"><i class="icon-dragon"></i></button>
    <button onclick="generateTemplate('fairy')"><i class="icon-fairy"></i></button>
    <button onclick="generateTemplate('all')"><i class="icon-ball"></i></button>
  </div>

    <div id="preview-container">
        <h2>Preview</h2>
        <div id="image-preview"></div>
    </div>

    <textarea id="html-template" rows="10" cols="50"></textarea>

    <script>
        // Fetch excluded Pokemon list from JSON file
        const excludedPokemonUrl = 'https://raw.githubusercontent.com/Hoenn-RP/hoenn-gachapon/main/excludedPokemon.json';

        function fetchExcludedPokemon(callback) {
            fetch(excludedPokemonUrl)
                .then(response => response.json())
                .then(data => callback(data))
                .catch(error => console.error('Error fetching excluded Pokemon:', error));
        }

        function getRandomPokemon(type, count, callback) {
            fetchExcludedPokemon(excludedPokemon => {
                const url = `https://pokeapi.co/api/v2/type/${type.toLowerCase()}/`;
                fetch(url)
                    .then(response => response.json())
                    .then(data => {
                        // Filter out excluded Pokemon names
                        const filteredPokemons = data.pokemon
                            .filter(entry => !excludedPokemon.includes(entry.pokemon.name));

                        const randomPokemons = [];
                        for (let i = 0; i < count; i++) {
                            const randomPokemon = filteredPokemons[Math.floor(Math.random() * filteredPokemons.length)].pokemon;
                            randomPokemons.push(randomPokemon);
                        }
                        callback(randomPokemons);
                    })
                    .catch(error => console.error('Error fetching Pokemon data:', error));
            });
        }

        function generateTemplate(type) {
            if (type.toLowerCase() === 'all') {
                generateAllTypes();
            } else {
                getRandomPokemon(type, 3, function (randomPokemons) {
                    displayTemplate(randomPokemons);
                });
            }
        }

        function generateAllTypes() {
            const allTypes = ['normal', 'fire', 'water', 'electric', 'grass', 'ice', 'fighting', 'poison', 'ground', 'flying', 'psychic', 'bug', 'rock', 'ghost', 'dark', 'steel', 'dragon', 'fairy'];

            const allRandomPokemons = [];
            let count = 3;

            function getRandomForType(type) {
                getRandomPokemon(type, 1, function (randomPokemons) {
                    allRandomPokemons.push(...randomPokemons);

                    if (allRandomPokemons.length === count) {
                        displayTemplate(allRandomPokemons);
                    }
                });
            }

            // Shuffle the types to get a random order
            const shuffledTypes = allTypes.sort(() => Math.random() - 0.5);

            for (let i = 0; i < count; i++) {
                getRandomForType(shuffledTypes[i]);
            }
        }

        function displayTemplate(randomPokemons) {
            const preview = `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Generated Pokemon</title>
    <!-- Add your additional head content here -->
</head>
<body>

    <h1>Your Generated Pokemon</h1>
    
    ${randomPokemons.map(pokemon => `
        <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${pokemon.url.split('/')[6]}.png" alt="${pokemon.name}" title="${pokemon.name}">
    `).join('')}

    <!-- Add your additional body content here -->

</body>
</html>
`;
            const template = `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Generated Pokemon</title>
    <!-- Add your additional head content here -->
</head>
<body>

    <h1>Your Generated Pokemon</h1>
    
    ${randomPokemons.map(pokemon => `
        [img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${pokemon.url.split('/')[6]}.png" alt="${pokemon.name}" title="${pokemon.name}"]
    `).join('')}

    <!-- Add your additional body content here -->

</body>
</html>
`;

            // Display in preview container
            document.getElementById('image-preview').innerHTML = preview;

            // Display in textarea
            document.getElementById('html-template').value = template;  // Clear the textarea
        }
    </script>

</body>
</html>

